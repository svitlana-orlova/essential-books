<!doctype html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="../../assets/main.css" rel="stylesheet">
</head>
<body class="page">
<header class="page__header">
    <div class="page__header__left">
        <a id="link-home" href="../../index.html">
            &nbsp;Essential Books</a>
    </div>
</header>
<div class="content">
    <div class="article">
      

<div style="display: flex; justify-content: space-between">
  <h1 class="title">Capture canvas and Save as webM video</h1>
  <a class="edit-link" style="font-size: 80%" href="https://notion.so/d869e996275e4b69bee63ead2b9e3bf1" rel="nofollow" target="_blank">suggest change</a>
</div>


      
<p>Creating a WebM video from canvas frames and playing in canvas, or upload, or downloading.
</p>
  <h2 id="7cb42b3d-f785-48b7-ab6c-ee8d55412583" class="">Example capture and play canvas
  <a class="header-anchor" href="capture-canvas-and-save-as-webm-video-d869e996275e4b69bee63ead2b9e3bf1.html#7cb42b3d-f785-48b7-ab6c-ee8d55412583" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 8 8"><path d="M5.88.03c-.18.01-.36.03-.53.09-.27.1-.53.25-.75.47a.5.5 0 1 0 .69.69c.11-.11.24-.17.38-.22.35-.12.78-.07 1.06.22.39.39.39 1.04 0 1.44l-1.5 1.5c-.44.44-.8.48-1.06.47-.26-.01-.41-.13-.41-.13a.5.5 0 1 0-.5.88s.34.22.84.25c.5.03 1.2-.16 1.81-.78l1.5-1.5c.78-.78.78-2.04 0-2.81-.28-.28-.61-.45-.97-.53-.18-.04-.38-.04-.56-.03zm-2 2.31c-.5-.02-1.19.15-1.78.75l-1.5 1.5c-.78.78-.78 2.04 0 2.81.56.56 1.36.72 2.06.47.27-.1.53-.25.75-.47a.5.5 0 1 0-.69-.69c-.11.11-.24.17-.38.22-.35.12-.78.07-1.06-.22-.39-.39-.39-1.04 0-1.44l1.5-1.5c.4-.4.75-.45 1.03-.44.28.01.47.09.47.09a.5.5 0 1 0 .44-.88s-.34-.2-.84-.22z"></path></svg></a>
  </h2>

<div class="code-box lang-Plain Text">
	<div>
	<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">name = "CanvasCapture"; // Placed into the Mux and Write Application Name fields of the WebM header
</span></span><span class="line"><span class="cl">quality = 0.7; // good quality 1 Best &lt; 0.7 ok to poor
</span></span><span class="line"><span class="cl">fps = 30; // I have tried all sorts of frame rates and all seem to work
</span></span><span class="line"><span class="cl">          // Do some test to workout what your machine can handle as there
</span></span><span class="line"><span class="cl">          // is a lot of variation between machines.
</span></span><span class="line"><span class="cl">var video = new Groover.Video(fps,quality,name)
</span></span><span class="line"><span class="cl">function capture(){
</span></span><span class="line"><span class="cl">    if(video.timecode &lt; 5000){ // 5 seconds
</span></span><span class="line"><span class="cl">         setTimeout(capture,video.frameDelay);             
</span></span><span class="line"><span class="cl">    }else{
</span></span><span class="line"><span class="cl">         var videoElement = document.createElement("video");
</span></span><span class="line"><span class="cl">         videoElement.src = URL.createObjectURL(video.toBlob());
</span></span><span class="line"><span class="cl">         document.body.appendChild(videoElement);
</span></span><span class="line"><span class="cl">         video = undefined; // DeReference as it is memory hungry.
</span></span><span class="line"><span class="cl">         return;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    // first frame sets the video size
</span></span><span class="line"><span class="cl">    video.addFrame(canvas); // Add current canvas frame
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">capture(); // start capture</span></span></code></pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div>
<p>Rather than put in a huge effort only to be rejected, this is a quick insert to see if acceptable. Will Give full details if accepted. Also include additional capture options for better HD capture rates (removed from this version, Can capture HD 1080 at 50fps on good machines.)
</p>
<p>This was inspired by <a href="https://github.com/antimatter15/whammy">Wammy</a> but is a complete rewrite with encode as you go methodology, greatly reducing the memory required during capture. Can capture more than 30 seconds better data, handling algorithms.
</p>
<blockquote id="d753b8ff-cef0-4f34-8714-0abc98aee078" class="">Note frames are encoded into webP images. Only Chrome supports webP canvas encoding. For other browsers (Firefox and Edge) you will need to use a 3rd party webP encoder such as Libwebp Javascript Encoding WebP images via Javascript is slow. (will include addition of raw webp images support if accepted).
</blockquote>
<p>The webM encoder inspired by <a href="https://github.com/antimatter15/whammy">Whammy: A Real Time Javascript WebM</a>
</p>

<div class="code-box lang-Plain Text">
	<div>
	<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">var Groover = (function(){
</span></span><span class="line"><span class="cl">    // ensure webp is supported 
</span></span><span class="line"><span class="cl">    function canEncode(){
</span></span><span class="line"><span class="cl">        var canvas = document.createElement("canvas");
</span></span><span class="line"><span class="cl">        canvas.width = 8;
</span></span><span class="line"><span class="cl">        canvas.height = 8;
</span></span><span class="line"><span class="cl">        return canvas.toDataURL("image/webp",0.1).indexOf("image/webp") &gt; -1;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    if(!canEncode()){
</span></span><span class="line"><span class="cl">        return undefined;
</span></span><span class="line"><span class="cl">    }    
</span></span><span class="line"><span class="cl">    var webmData = null;
</span></span><span class="line"><span class="cl">    var clusterTimecode = 0;
</span></span><span class="line"><span class="cl">    var clusterCounter = 0;
</span></span><span class="line"><span class="cl">    var CLUSTER_MAX_DURATION = 30000;
</span></span><span class="line"><span class="cl">    var frameNumber = 0;
</span></span><span class="line"><span class="cl">    var width;
</span></span><span class="line"><span class="cl">    var height;
</span></span><span class="line"><span class="cl">    var frameDelay;
</span></span><span class="line"><span class="cl">    var quality;
</span></span><span class="line"><span class="cl">    var name;
</span></span><span class="line"><span class="cl">    const videoMimeType = "video/webm"; // the only one.
</span></span><span class="line"><span class="cl">    const frameMimeType = 'image/webp'; // can be no other
</span></span><span class="line"><span class="cl">    const S = String.fromCharCode;
</span></span><span class="line"><span class="cl">    const dataTypes = {
</span></span><span class="line"><span class="cl">        object : function(data){ return toBlob(data);},
</span></span><span class="line"><span class="cl">        number : function(data){ return stream.num(data);},
</span></span><span class="line"><span class="cl">        string : function(data){ return stream.str(data);},
</span></span><span class="line"><span class="cl">        array  : function(data){ return data;}, 
</span></span><span class="line"><span class="cl">        double2Str : function(num){
</span></span><span class="line"><span class="cl">            var c = new Uint8Array((new Float64Array([num])).buffer);
</span></span><span class="line"><span class="cl">            return S(c[7]) + S(c[6]) + S(c[5]) + S(c[4]) + S(c[3]) + S(c[2]) + S(c[1]) + S(c[0]);
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">    };    
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">    const stream = {
</span></span><span class="line"><span class="cl">        num : function(num){ // writes int
</span></span><span class="line"><span class="cl">            var parts = [];
</span></span><span class="line"><span class="cl">            while(num &gt; 0){ parts.push(num &amp; 0xff); num = num &gt;&gt; 8; }
</span></span><span class="line"><span class="cl">            return new Uint8Array(parts.reverse());
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">        str : function(str){ // writes string
</span></span><span class="line"><span class="cl">            var i, len, arr;
</span></span><span class="line"><span class="cl">            len = str.length;
</span></span><span class="line"><span class="cl">            arr = new Uint8Array(len);
</span></span><span class="line"><span class="cl">            for(i = 0; i &lt; len; i++){arr[i] = str.charCodeAt(i);}
</span></span><span class="line"><span class="cl">            return arr;
</span></span><span class="line"><span class="cl">        },
</span></span><span class="line"><span class="cl">        compInt : function(num){ // could not find full details so bit of a guess
</span></span><span class="line"><span class="cl">            if(num &lt; 128){       // number is prefixed with a bit (1000 is on byte 0100 two, 0010 three and so on)
</span></span><span class="line"><span class="cl">                num += 0x80;
</span></span><span class="line"><span class="cl">                return new Uint8Array([num]);
</span></span><span class="line"><span class="cl">            }else
</span></span><span class="line"><span class="cl">            if(num &lt; 0x4000){
</span></span><span class="line"><span class="cl">                num += 0x4000;
</span></span><span class="line"><span class="cl">                return new Uint8Array([num&gt;&gt;8, num])
</span></span><span class="line"><span class="cl">            }else
</span></span><span class="line"><span class="cl">            if(num &lt; 0x200000){
</span></span><span class="line"><span class="cl">                num += 0x200000;
</span></span><span class="line"><span class="cl">                return new Uint8Array([num&gt;&gt;16, num&gt;&gt;8, num])
</span></span><span class="line"><span class="cl">            }else
</span></span><span class="line"><span class="cl">            if(num &lt; 0x10000000){
</span></span><span class="line"><span class="cl">                num += 0x10000000;
</span></span><span class="line"><span class="cl">                return new Uint8Array([num&gt;&gt;24, num&gt;&gt;16, num&gt;&gt;8, num])
</span></span><span class="line"><span class="cl">            }            
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    const ids = { // header names and values
</span></span><span class="line"><span class="cl">        videoData          : 0x1a45dfa3, 
</span></span><span class="line"><span class="cl">        Version            : 0x4286,
</span></span><span class="line"><span class="cl">        ReadVersion        : 0x42f7,
</span></span><span class="line"><span class="cl">        MaxIDLength        : 0x42f2,
</span></span><span class="line"><span class="cl">        MaxSizeLength      : 0x42f3,
</span></span><span class="line"><span class="cl">        DocType            : 0x4282,
</span></span><span class="line"><span class="cl">        DocTypeVersion     : 0x4287,
</span></span><span class="line"><span class="cl">        DocTypeReadVersion : 0x4285,
</span></span><span class="line"><span class="cl">        Segment            : 0x18538067,
</span></span><span class="line"><span class="cl">        Info               : 0x1549a966,
</span></span><span class="line"><span class="cl">        TimecodeScale      : 0x2ad7b1,
</span></span><span class="line"><span class="cl">        MuxingApp          : 0x4d80,
</span></span><span class="line"><span class="cl">        WritingApp         : 0x5741,
</span></span><span class="line"><span class="cl">        Duration           : 0x4489,
</span></span><span class="line"><span class="cl">        Tracks             : 0x1654ae6b,
</span></span><span class="line"><span class="cl">        TrackEntry         : 0xae,
</span></span><span class="line"><span class="cl">        TrackNumber        : 0xd7,
</span></span><span class="line"><span class="cl">        TrackUID           : 0x63c5,
</span></span><span class="line"><span class="cl">        FlagLacing         : 0x9c,
</span></span><span class="line"><span class="cl">        Language           : 0x22b59c,
</span></span><span class="line"><span class="cl">        CodecID            : 0x86,
</span></span><span class="line"><span class="cl">        CodecName          : 0x258688,
</span></span><span class="line"><span class="cl">        TrackType          : 0x83,
</span></span><span class="line"><span class="cl">        Video              : 0xe0,
</span></span><span class="line"><span class="cl">        PixelWidth         : 0xb0,
</span></span><span class="line"><span class="cl">        PixelHeight        : 0xba,
</span></span><span class="line"><span class="cl">        Cluster            : 0x1f43b675,
</span></span><span class="line"><span class="cl">        Timecode           : 0xe7,
</span></span><span class="line"><span class="cl">        Frame              : 0xa3,
</span></span><span class="line"><span class="cl">        Keyframe           : 0x9d012a,
</span></span><span class="line"><span class="cl">        FrameBlock         : 0x81,
</span></span><span class="line"><span class="cl">    };
</span></span><span class="line"><span class="cl">    const keyframeD64Header = '\x9d\x01\x2a'; //VP8 keyframe header 0x9d012a
</span></span><span class="line"><span class="cl">    const videoDataPos = 1; // data pos of frame data header
</span></span><span class="line"><span class="cl">    const defaultDelay = dataTypes.double2Str(1000/25);
</span></span><span class="line"><span class="cl">    const header = [  // structure of webM header/chunks what ever they are called.
</span></span><span class="line"><span class="cl">        ids.videoData,[
</span></span><span class="line"><span class="cl">            ids.Version, 1,
</span></span><span class="line"><span class="cl">            ids.ReadVersion, 1,
</span></span><span class="line"><span class="cl">            ids.MaxIDLength, 4,
</span></span><span class="line"><span class="cl">            ids.MaxSizeLength, 8,
</span></span><span class="line"><span class="cl">            ids.DocType, 'webm',
</span></span><span class="line"><span class="cl">            ids.DocTypeVersion, 2,
</span></span><span class="line"><span class="cl">            ids.DocTypeReadVersion, 2
</span></span><span class="line"><span class="cl">        ],
</span></span><span class="line"><span class="cl">        ids.Segment, [
</span></span><span class="line"><span class="cl">            ids.Info, [
</span></span><span class="line"><span class="cl">                ids.TimecodeScale, 1000000,
</span></span><span class="line"><span class="cl">                ids.MuxingApp, 'Groover',
</span></span><span class="line"><span class="cl">                ids.WritingApp, 'Groover',
</span></span><span class="line"><span class="cl">                ids.Duration, 0
</span></span><span class="line"><span class="cl">            ],
</span></span><span class="line"><span class="cl">            ids.Tracks,[
</span></span><span class="line"><span class="cl">                ids.TrackEntry,[
</span></span><span class="line"><span class="cl">                    ids.TrackNumber, 1,
</span></span><span class="line"><span class="cl">                    ids.TrackUID, 1,
</span></span><span class="line"><span class="cl">                    ids.FlagLacing, 0,     // always o
</span></span><span class="line"><span class="cl">                    ids.Language, 'und',   // undefined I think this means
</span></span><span class="line"><span class="cl">                    ids.CodecID, 'V_VP8',  // These I think must not change
</span></span><span class="line"><span class="cl">                    ids.CodecName, 'VP8',  // These I think must not change
</span></span><span class="line"><span class="cl">                    ids.TrackType, 1,
</span></span><span class="line"><span class="cl">                    ids.Video, [
</span></span><span class="line"><span class="cl">                        ids.PixelWidth, 0,
</span></span><span class="line"><span class="cl">                        ids.PixelHeight, 0
</span></span><span class="line"><span class="cl">                    ]
</span></span><span class="line"><span class="cl">                ]
</span></span><span class="line"><span class="cl">            ]
</span></span><span class="line"><span class="cl">        ]
</span></span><span class="line"><span class="cl">    ];    
</span></span><span class="line"><span class="cl">    function getHeader(){
</span></span><span class="line"><span class="cl">        header[3][2][3] = name;
</span></span><span class="line"><span class="cl">        header[3][2][5] = name;
</span></span><span class="line"><span class="cl">        header[3][2][7] =  dataTypes.double2Str(frameDelay);
</span></span><span class="line"><span class="cl">        header[3][3][1][15][1] =  width;
</span></span><span class="line"><span class="cl">        header[3][3][1][15][3] =  height;
</span></span><span class="line"><span class="cl">        function create(dat){
</span></span><span class="line"><span class="cl">            var i,kv,data;
</span></span><span class="line"><span class="cl">            data = [];
</span></span><span class="line"><span class="cl">            for(i = 0; i &lt; dat.length; i += 2){
</span></span><span class="line"><span class="cl">                kv = {i : dat[i]};
</span></span><span class="line"><span class="cl">                if(Array.isArray(dat[i + 1])){
</span></span><span class="line"><span class="cl">                    kv.d = create(dat[i + 1]);
</span></span><span class="line"><span class="cl">                }else{
</span></span><span class="line"><span class="cl">                    kv.d = dat[i + 1];
</span></span><span class="line"><span class="cl">                }
</span></span><span class="line"><span class="cl">                data.push(kv);
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">            return data;
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">        return create(header);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    function addCluster(){
</span></span><span class="line"><span class="cl">        webmData[videoDataPos].d.push({ i: ids.Cluster,d: [{ i: ids.Timecode, d: Math.round(clusterTimecode)}]}); // Fixed bug with Round
</span></span><span class="line"><span class="cl">        clusterCounter = 0;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    function addFrame(frame){
</span></span><span class="line"><span class="cl">        var VP8, kfS,riff;
</span></span><span class="line"><span class="cl">        riff = getWebPChunks(atob(frame.toDataURL(frameMimeType, quality).slice(23)));
</span></span><span class="line"><span class="cl">        VP8 = riff.RIFF[0].WEBP[0];
</span></span><span class="line"><span class="cl">        kfS = VP8.indexOf(keyframeD64Header) + 3;
</span></span><span class="line"><span class="cl">        frame = {
</span></span><span class="line"><span class="cl">            width: ((VP8.charCodeAt(kfS + 1) &lt;&lt; 8) | VP8.charCodeAt(kfS)) &amp; 0x3FFF,
</span></span><span class="line"><span class="cl">            height: ((VP8.charCodeAt(kfS + 3) &lt;&lt; 8) | VP8.charCodeAt(kfS + 2)) &amp; 0x3FFF,
</span></span><span class="line"><span class="cl">            data: VP8,
</span></span><span class="line"><span class="cl">            riff: riff
</span></span><span class="line"><span class="cl">        };
</span></span><span class="line"><span class="cl">        if(clusterCounter &gt; CLUSTER_MAX_DURATION){
</span></span><span class="line"><span class="cl">            addCluster();            
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">        webmData[videoDataPos].d[webmData[videoDataPos].d.length-1].d.push({
</span></span><span class="line"><span class="cl">            i: ids.Frame, 
</span></span><span class="line"><span class="cl">            d: S(ids.FrameBlock) + S( Math.round(clusterCounter) &gt;&gt; 8) +  S( Math.round(clusterCounter) &amp; 0xff) + S(128) + frame.data.slice(4),
</span></span><span class="line"><span class="cl">        });
</span></span><span class="line"><span class="cl">        clusterCounter += frameDelay;        
</span></span><span class="line"><span class="cl">        clusterTimecode += frameDelay;
</span></span><span class="line"><span class="cl">        webmData[videoDataPos].d[0].d[3].d = dataTypes.double2Str(clusterTimecode);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    function startEncoding(){
</span></span><span class="line"><span class="cl">        frameNumber = clusterCounter = clusterTimecode = 0;
</span></span><span class="line"><span class="cl">        webmData  = getHeader();
</span></span><span class="line"><span class="cl">        addCluster();
</span></span><span class="line"><span class="cl">    }    
</span></span><span class="line"><span class="cl">    function toBlob(vidData){
</span></span><span class="line"><span class="cl">        var data,i,vData, len;
</span></span><span class="line"><span class="cl">        vData = [];
</span></span><span class="line"><span class="cl">        for(i = 0; i &lt; vidData.length; i++){
</span></span><span class="line"><span class="cl">            data = dataTypes[typeof vidData[i].d](vidData[i].d);
</span></span><span class="line"><span class="cl">            len  = data.size || data.byteLength || data.length;
</span></span><span class="line"><span class="cl">            vData.push(stream.num(vidData[i].i));
</span></span><span class="line"><span class="cl">            vData.push(stream.compInt(len));
</span></span><span class="line"><span class="cl">            vData.push(data)
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">        return new Blob(vData, {type: videoMimeType});
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    function getWebPChunks(str){
</span></span><span class="line"><span class="cl">        var offset, chunks, id, len, data;
</span></span><span class="line"><span class="cl">        offset = 0;
</span></span><span class="line"><span class="cl">        chunks = {};
</span></span><span class="line"><span class="cl">        while (offset &lt; str.length) {
</span></span><span class="line"><span class="cl">            id = str.substr(offset, 4);
</span></span><span class="line"><span class="cl">            // value will have top bit on (bit 32) so not simply a bitwise operation
</span></span><span class="line"><span class="cl">            // Warning little endian (Will not work on big endian systems)
</span></span><span class="line"><span class="cl">            len = new Uint32Array(
</span></span><span class="line"><span class="cl">                new Uint8Array([
</span></span><span class="line"><span class="cl">                    str.charCodeAt(offset + 7),
</span></span><span class="line"><span class="cl">                    str.charCodeAt(offset + 6),
</span></span><span class="line"><span class="cl">                    str.charCodeAt(offset + 5),
</span></span><span class="line"><span class="cl">                    str.charCodeAt(offset + 4)
</span></span><span class="line"><span class="cl">                ]).buffer)[0];
</span></span><span class="line"><span class="cl">            id = str.substr(offset, 4);
</span></span><span class="line"><span class="cl">            chunks[id] = chunks[id] === undefined ? [] : chunks[id];
</span></span><span class="line"><span class="cl">            if (id === 'RIFF' || id === 'LIST') {
</span></span><span class="line"><span class="cl">                chunks[id].push(getWebPChunks(str.substr(offset + 8, len)));
</span></span><span class="line"><span class="cl">                offset += 8 + len;
</span></span><span class="line"><span class="cl">            } else if (id === 'WEBP') {
</span></span><span class="line"><span class="cl">                chunks[id].push(str.substr(offset + 8));
</span></span><span class="line"><span class="cl">                break;
</span></span><span class="line"><span class="cl">            } else {
</span></span><span class="line"><span class="cl">                chunks[id].push(str.substr(offset + 4));
</span></span><span class="line"><span class="cl">                break;
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">        return chunks;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    function Encoder(fps, _quality = 0.8, _name = "Groover"){ 
</span></span><span class="line"><span class="cl">        this.fps = fps;
</span></span><span class="line"><span class="cl">        this.quality = quality = _quality;
</span></span><span class="line"><span class="cl">        this.frameDelay = frameDelay = 1000 / fps;
</span></span><span class="line"><span class="cl">        this.frame = 0;
</span></span><span class="line"><span class="cl">        this.width = width = null;
</span></span><span class="line"><span class="cl">        this.timecode = 0;
</span></span><span class="line"><span class="cl">        this.name = name = _name;
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    Encoder.prototype = {
</span></span><span class="line"><span class="cl">        addFrame : function(frame){
</span></span><span class="line"><span class="cl">            if('canvas' in frame){
</span></span><span class="line"><span class="cl">                frame = frame.canvas;    
</span></span><span class="line"><span class="cl">            }
</span></span><span class="line"><span class="cl">            if(width === null){
</span></span><span class="line"><span class="cl">                this.width = width = frame.width,
</span></span><span class="line"><span class="cl">                this.height = height = frame.height
</span></span><span class="line"><span class="cl">                startEncoding();
</span></span><span class="line"><span class="cl">            }else
</span></span><span class="line"><span class="cl">            if(width !== frame.width || height !== frame.height){
</span></span><span class="line"><span class="cl">                throw RangeError("Frame size error. Frames must be the same size.");
</span></span><span class="line"><span class="cl">            }            
</span></span><span class="line"><span class="cl">            addFrame(frame);   
</span></span><span class="line"><span class="cl">            this.frame += 1;
</span></span><span class="line"><span class="cl">            this.timecode = clusterTimecode;
</span></span><span class="line"><span class="cl">        },        
</span></span><span class="line"><span class="cl">        toBlob : function(){
</span></span><span class="line"><span class="cl">            return toBlob(webmData);
</span></span><span class="line"><span class="cl">        }
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">    return {
</span></span><span class="line"><span class="cl">        Video: Encoder,
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">})()</span></span></code></pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div>

      <div class="forum-link">
  Found a mistake? Have a question or improvement idea?
  <a href="capture-canvas-and-save-as-webm-video-d869e996275e4b69bee63ead2b9e3bf1.html#" onclick="showContact(); return false;">Let me know</a>.
</div>

      <form id="contact-form" action="https://formsubmit.co/kkowalczyk@gmail.com" method="POST">
  <p>
    </p><div class="contact-light">Feedback about page:</div>
    <input type="text" name="page-url" id="contact-page-url" readonly>
  

  <p>
    </p><div class="contact-light">Feedback:</div>
    <textarea name="message" id="msg-for-chris"></textarea>
    <div class="contact-light">Optional: your email if you want me to get back to you: </div>
    <input type="email" name="email">
    <input type="hidden" name="_template" value="box">
    <input type="text" name="_honey" class="noshow">
  

  <p>
    <button type="submit" class="contact-btn">
      Send Feedback
    </button>

    <button class="contact-btn" style="float: right;" onclick="hideContact(); return false;">
      Cancel
    </button>
  </p>
</form>


      <hr class="article-bottom-sep">
    </div>

    <div id="page-toc"><div class="article chapter-toc svelte-1t851gm"><div class="mtoc-0 svelte-1t851gm"><b>Media types and the canvas:</b></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="media-types-and-the-canvas-776dcd2166d64075931bbc829bc864b0.html">Media types and the canvas</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="basic-loading-and-playing-a-video-on-the-canvas.-ec39f3c40c6d42dd97ae0fa7ba650bfb.html">Basic loading and playing a video on the canvas.</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="loading-and-displaying-an-image-8a98b36a4ebc4775a31f8cb8c5e2ea8f.html">Loading and displaying an Image</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="drawing-an-svg-image-d39f9af23d5342aa8803148d26582f7c.html">Drawing an svg image</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><b>Capture canvas and Save as webM video</b></div></div></div>

    <div id="chapter-toc-wrapper">
      <hr>
      <div class="hdr">Table Of Contents</div>
      <div id="book-toc"><div class="article toc svelte-1ib47n1"><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">0</span><a href="getting-started-7d650957f57448d485d0f1426726d652.html">Getting started</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">1</span><a href="images-ba65754ede34461eb1e1560e2d6309e4.html">Images</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">2</span><a href="path-syntax-db570444b7a84c65af507de125251743.html">Path syntax</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">3</span><b>Media types and the canvas</b></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">4</span><a href="animation-43473e4727d0430a914dcd63a767322a.html">Animation</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">5</span><a href="collisions-and-intersections-c37198bed8f348ef8bfc2cebe79b5d8b.html">Collisions and intersections</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">6</span><a href="paths-041fccaeeb964fce95770aaf8da6dad2.html">Paths</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">7</span><a href="text-0d20929db8564186bfedfbeecbb675d5.html">Text</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">8</span><a href="clearing-the-screen-28d114e4408844fc827c5f73d6238ff8.html">Clearing the screen</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">9</span><a href="navigating-along-a-path-69ada749d57144f89e7e47f98efde9a1.html">Navigating along a path</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">10</span><a href="dragging-path-shapes-images-dd776e0ee2284dd699b4439d20e57076.html">Dragging path shapes images</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">11</span><a href="shadows-15ffc1665db0493fb2645df513042ee7.html">Shadows</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">12</span><a href="charts-diagrams-55c84186869841c98d2d873c9b4a19c9.html">Charts diagrams</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">13</span><a href="polygons-e6a83a07a60745f6884992715cb6dc6b.html">Polygons</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">14</span><a href="transformations-90e27c4187894f0499f3a04940f3821a.html">Transformations</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">15</span><a href="responsive-design-d29786c782594e778b8c65265f7b95e3.html">Responsive design</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">16</span><a href="compositing-de5b9aa74f444592b8f347684b3408b3.html">Compositing</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">17</span><a href="pixel-manipulation-ac5cc01d563d4c52a3602801411c5860.html">Pixel manipulation</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">18</span><a href="contributors-bdca4d70e7e644fe95706e68527f05d6.html">Contributors</a></div></div></div></div>
    </div>
  </div></body>
</html>