<!doctype html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="../../assets/main.css" rel="stylesheet">
</head>
<body class="page">
<header class="page__header">
    <div class="page__header__left">
        <a id="link-home" href="../../index.html">
            &nbsp;Essential Books</a>
    </div>
</header>
<div class="content">
    <div class="article">
      

<div style="display: flex; justify-content: space-between">
  <h1 class="title">Use requestAnimationFrame NOT setInterval for animation loops</h1>
  <a class="edit-link" style="font-size: 80%" href="https://notion.so/5812819bb2c14685a9fbb0a2b3e80b5a" rel="nofollow" target="_blank">suggest change</a>
</div>


      
<p><code>requestAnimationFrame</code> is similar to setInterval, it but has these important improvements:
</p>
  <ul id="9a252668-128b-4c67-99ba-bd22bd312c74" class="bulleted-list">
    <li>The animation code is synchronized with display refreshes for efficiency The clear + redraw code is scheduled, but not immediately executed. The browser will execute the clear + redraw code only when the display is ready to refresh. This synchronization with the refresh cycle increases your animation performance by giving your code the most available time in which to complete.
    </li>
    <li>Every loop is always completed before another loop is allowed to start. This prevents “tearing”, where the user sees an incomplete version of the drawing. The eye particularly notices tearing and is distracted when tearing occurs. So preventing tearing makes your animation appear smoother and more consistent.
    </li>
    <li>Animation automatically stops when the user switches to a different browser tab. This saves power on mobile devices because the device is not wasting power computing an animation that the user can’t currently see.
    </li>
  </ul>
<p>Device displays will refresh about 60 times per second so requestAnimationFrame can continuously redraw at about 60 “frames” per second. The eye sees motion at 20-30 frames per second so requestAnimationFrame can easily create the illusion of motion.
</p>
<p>Notice that requestAnimationFrame is recalled at the end of each animateCircle. This is because each ’requestAnimatonFrameonly requests a single execution of the animation function.
</p>
<p><strong>Example: simple `requestAnimationFrame</strong>
</p>

<div class="code-box lang-Plain Text">
	<div>
	<pre tabindex="0" class="chroma"><code><span class="line"><span class="cl">&lt;!doctype html&gt;
</span></span><span class="line"><span class="cl">&lt;html&gt;
</span></span><span class="line"><span class="cl">&lt;head&gt;
</span></span><span class="line"><span class="cl">&lt;style&gt;
</span></span><span class="line"><span class="cl">    body{ background-color:white; }
</span></span><span class="line"><span class="cl">    #canvas{border:1px solid red; }
</span></span><span class="line"><span class="cl">&lt;/style&gt;
</span></span><span class="line"><span class="cl">&lt;script&gt;
</span></span><span class="line"><span class="cl">window.onload=(function(){
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    // canvas related variables
</span></span><span class="line"><span class="cl">    var canvas=document.getElementById("canvas");
</span></span><span class="line"><span class="cl">    var ctx=canvas.getContext("2d");
</span></span><span class="line"><span class="cl">    var cw=canvas.width;
</span></span><span class="line"><span class="cl">    var ch=canvas.height;
</span></span><span class="line"><span class="cl">           
</span></span><span class="line"><span class="cl">    // start the animation
</span></span><span class="line"><span class="cl">    requestAnimationFrame(animate);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    function animate(currentTime){
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        // draw a full randomly circle
</span></span><span class="line"><span class="cl">        var x=Math.random()*canvas.width;
</span></span><span class="line"><span class="cl">        var y=Math.random()*canvas.height;
</span></span><span class="line"><span class="cl">        var radius=10+Math.random()*15;
</span></span><span class="line"><span class="cl">        ctx.beginPath();
</span></span><span class="line"><span class="cl">        ctx.arc(x,y,radius,0,Math.PI*2);
</span></span><span class="line"><span class="cl">        ctx.fillStyle='#'+Math.floor(Math.random()*16777215).toString(16);
</span></span><span class="line"><span class="cl">        ctx.fill();
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        // request another loop of animation
</span></span><span class="line"><span class="cl">        requestAnimationFrame(animate);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">}); // end $(function(){});
</span></span><span class="line"><span class="cl">&lt;/script&gt;
</span></span><span class="line"><span class="cl">&lt;/head&gt;
</span></span><span class="line"><span class="cl">&lt;body&gt;
</span></span><span class="line"><span class="cl">    &lt;canvas id="canvas" width=512 height=512&gt;&lt;/canvas&gt;
</span></span><span class="line"><span class="cl">&lt;/body&gt;
</span></span><span class="line"><span class="cl">&lt;/html&gt;</span></span></code></pre>
	</div>
	<div class="code-box-nav">
		
	</div>
</div>
<p>To illustrate the advantages of requestAnimationFrame this <a href="http://stackoverflow.com/a/38709924/3877726">stackoverflow question has a live demo</a>
</p>

      <div class="forum-link">
  Found a mistake? Have a question or improvement idea?
  <a href="use-requestanimationframe-not-setinterval-for-animation-loops-5812819bb2c14685a9fbb0a2b3e80b5a.html#" onclick="showContact(); return false;">Let me know</a>.
</div>

      <form id="contact-form" action="https://formsubmit.co/kkowalczyk@gmail.com" method="POST">
  <p>
    </p><div class="contact-light">Feedback about page:</div>
    <input type="text" name="page-url" id="contact-page-url" readonly>
  

  <p>
    </p><div class="contact-light">Feedback:</div>
    <textarea name="message" id="msg-for-chris"></textarea>
    <div class="contact-light">Optional: your email if you want me to get back to you: </div>
    <input type="email" name="email">
    <input type="hidden" name="_template" value="box">
    <input type="text" name="_honey" class="noshow">
  

  <p>
    <button type="submit" class="contact-btn">
      Send Feedback
    </button>

    <button class="contact-btn" style="float: right;" onclick="hideContact(); return false;">
      Cancel
    </button>
  </p>
</form>


      <hr class="article-bottom-sep">
    </div>

    <div id="page-toc"><div class="article chapter-toc svelte-1t851gm"><div class="mtoc-0 svelte-1t851gm"><b>Animation:</b></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="animation-ad7e7b9fb57f4006b073f9770c78b672.html">Animation</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><b>Use requestAnimationFrame NOT setInterval for animation loops</b></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="animate-an-image-across-the-canvas-5fca16d1d8a24d268081159bace1fa4a.html">Animate an image across the Canvas</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="animate-at-a-specified-interval-add-a-new-rectangle-every-1-second-21ba6d231ae140d48b34029d2293aa72.html">Animate at a specified interval add a new rectangle every 1 second</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="animate-at-a-specified-time-an-animated-clock-a17f3846152743c4afc34650016f7fb4.html">Animate at a specified time an animated clock</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="dont-draw-animations-in-your-event-handlers-a-simple-sketch-app-8d4c4f489fb24f05ace50f886de2563a.html">Dont draw animations in your event handlers a simple sketch app</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="easing-using-robert-penners-equations-24984e75aa774fb6b3c673827605fef8.html">Easing using Robert Penners equations</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="set-frame-rate-using-requestanimationframe-5f707250cb024cd1a3b30850f47b6cb9.html">Set frame rate using requestAnimationFrame</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="simple-animation-with-2d-context-and-requestanimationframe-33aa3726ce6f4b4e9d763a7374e42113.html">Simple animation with 2D context and requestAnimationFrame</a></div><div class="mtoc-1 svelte-1t851gm"><span class="no svelte-1ib47n1">*</span><a href="animate-from-x0y0-to-x1y1-6df1312a67f64e1db33865e8e9f04397.html">Animate from x0y0 to x1y1</a></div></div></div>

    <div id="chapter-toc-wrapper">
      <hr>
      <div class="hdr">Table Of Contents</div>
      <div id="book-toc"><div class="article toc svelte-1ib47n1"><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">0</span><a href="getting-started-7d650957f57448d485d0f1426726d652.html">Getting started</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">1</span><a href="images-ba65754ede34461eb1e1560e2d6309e4.html">Images</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">2</span><a href="path-syntax-db570444b7a84c65af507de125251743.html">Path syntax</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">3</span><a href="media-types-and-the-canvas-4ce6605a6537475291ee3480df7bacb9.html">Media types and the canvas</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">4</span><b>Animation</b></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">5</span><a href="collisions-and-intersections-c37198bed8f348ef8bfc2cebe79b5d8b.html">Collisions and intersections</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">6</span><a href="paths-041fccaeeb964fce95770aaf8da6dad2.html">Paths</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">7</span><a href="text-0d20929db8564186bfedfbeecbb675d5.html">Text</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">8</span><a href="clearing-the-screen-28d114e4408844fc827c5f73d6238ff8.html">Clearing the screen</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">9</span><a href="navigating-along-a-path-69ada749d57144f89e7e47f98efde9a1.html">Navigating along a path</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">10</span><a href="dragging-path-shapes-images-dd776e0ee2284dd699b4439d20e57076.html">Dragging path shapes images</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">11</span><a href="shadows-15ffc1665db0493fb2645df513042ee7.html">Shadows</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">12</span><a href="charts-diagrams-55c84186869841c98d2d873c9b4a19c9.html">Charts diagrams</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">13</span><a href="polygons-e6a83a07a60745f6884992715cb6dc6b.html">Polygons</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">14</span><a href="transformations-90e27c4187894f0499f3a04940f3821a.html">Transformations</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">15</span><a href="responsive-design-d29786c782594e778b8c65265f7b95e3.html">Responsive design</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">16</span><a href="compositing-de5b9aa74f444592b8f347684b3408b3.html">Compositing</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">17</span><a href="pixel-manipulation-ac5cc01d563d4c52a3602801411c5860.html">Pixel manipulation</a></div></div><div class="toc-item"><div class="chapters-toc-item"><span class="no svelte-1ib47n1">18</span><a href="contributors-bdca4d70e7e644fe95706e68527f05d6.html">Contributors</a></div></div></div></div>
    </div>
  </div></body>
</html>